<div class="qr-page-container" [style.direction]="lang.currentLanguage === 'he' ? 'rtl' : 'ltr'">
  @if (loading) {
    <div class="loading-container">
      <div class="loading-spinner"></div>
      <p class="loading-text">{{ lang.currentLanguage === 'he' ? 'טוען...' : 'Loading...' }}</p>
    </div>
  }

  @if (error && !loading) {
    <div class="error-container">
      <div class="error-icon">❌</div>
      <h2 class="error-title">{{ lang.currentLanguage === 'he' ? 'שגיאה' : 'Error' }}</h2>
      <p class="error-message">
        {{ lang.currentLanguage === 'he'
          ? 'לא ניתן למצוא את השאלון'
          : 'Questionnaire not found' }}
      </p>
    </div>
  }

  @if (!loading && !error && qrCodeDataUrl) {
    <div class="qr-content">
      <!-- Header with branding -->
      <div class="qr-header">
        @if (logoUrl) {
          <img [src]="logoUrl" [alt]="businessName" class="business-logo" />
        }
        @if (businessName) {
          <h1 class="business-name" [style.color]="primaryColor">{{ businessName }}</h1>
        }
      </div>

      <!-- QR Code Section -->
      <div class="qr-section">
        <h2 class="qr-title" [style.color]="primaryColor">
          {{ questionnaireTitle }}
        </h2>

        <div class="qr-instructions">
          <p>
            {{ lang.currentLanguage === 'he'
              ? 'סרוק את קוד ה-QR למילוי השאלון'
              : 'Scan the QR code to fill out the questionnaire' }}
          </p>
        </div>

        <div class="qr-code-container">
          <div class="qr-code-wrapper" [style.border-color]="primaryColor">
            <img [src]="qrCodeDataUrl" alt="QR Code" class="qr-code-image" />
          </div>
        </div>

        <div class="qr-footer">
          <button
            class="download-button"
            [style.background-color]="primaryColor"
            (click)="downloadQRCode()">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="7 10 12 15 17 10"></polyline>
              <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
            <span>
              {{ lang.currentLanguage === 'he' ? 'הורד QR' : 'Download QR Code' }}
            </span>
          </button>
        </div>
      </div>
    </div>
  }
</div>
